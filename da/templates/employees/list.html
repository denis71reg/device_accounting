{% extends "base.html" %}
{% block title %}–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ ¬∑ DA{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="mb-0" style="color: #2c3e50; font-weight: 600;">üë• –°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</h3>
    {% if current_user.is_authenticated and current_user.is_admin %}
    <div class="btn-group">
        <a href="{{ url_for('employees.import_employees') }}" class="btn btn-outline-primary"><i class="bi bi-file-earmark-excel me-1"></i>–ò–º–ø–æ—Ä—Ç</a>
        <a href="{{ url_for('employees.create_employee') }}" class="btn btn-primary"><i class="bi bi-person-plus me-1"></i>–î–æ–±–∞–≤–∏—Ç—å</a>
    </div>
    {% endif %}
</div>

<div class="card">
    <div class="card-body p-0">
        <table class="table table-hover mb-0 align-middle">
            <thead class="text-uppercase small">
                <tr>
                    <th class="ps-4" style="color: #2c3e50;">–§–ò–û</th>
                    <th style="color: #2c3e50;">–î–æ–ª–∂–Ω–æ—Å—Ç—å</th>
                    <th style="color: #2c3e50;">–ö–æ–Ω—Ç–∞–∫—Ç—ã</th>
                    <th style="color: #2c3e50;">–õ–æ–∫–∞—Ü–∏—è</th>
                    <th style="color: #2c3e50;" class="text-center">–î–µ–≤–∞–π—Å—ã</th>
                    <th class="text-end pe-4" style="color: #2c3e50;">–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
            {% for emp, device_count in employees_with_counts %}
                <tr>
                    <td class="ps-4 fw-semibold" style="color: #2c3e50; font-size: 1rem;">{{ emp.full_name }}</td>
                    <td style="color: #5a6c7d;">{{ emp.position }}</td>
                    <td class="small" style="color: #34495e; line-height: 1.8;">
                        <div style="color: #2c3e50; font-weight: 500;">
                            <a href="mailto:{{ emp.email }}" 
                               style="color: #2c3e50; text-decoration: none;"
                               title="–ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ –Ω–∞ {{ emp.email }}"
                               onmouseover="this.style.textDecoration='underline'; this.style.color='#3498db';"
                               onmouseout="this.style.textDecoration='none'; this.style.color='#2c3e50';">
                                <i class="bi bi-envelope me-1"></i>{{ emp.email }}
                            </a>
                        </div>
                        <div style="color: #5a6c7d;">{{ emp.phone }}</div>
                        {% if emp.telegram %}
                        <div style="color: #3498db;">
                            {% set telegram_username = emp.telegram.replace('@', '') if emp.telegram.startswith('@') else emp.telegram %}
                            <a href="tg://resolve?domain={{ telegram_username }}" 
                               style="color: #3498db; text-decoration: none;"
                               title="–û—Ç–∫—Ä—ã—Ç—å {{ emp.telegram }} –≤ Telegram"
                               onmouseover="this.style.textDecoration='underline'; this.style.color='#0088cc';"
                               onmouseout="this.style.textDecoration='none'; this.style.color='#3498db';">
                                <i class="bi bi-telegram me-1"></i>{{ emp.telegram }}
                            </a>
                        </div>
                        {% endif %}
                    </td>
                    <td style="color: #5a6c7d;">{{ emp.location.name if emp.location else '‚Äî' }}</td>
                    <td class="text-center">
                        {% if device_count > 0 %}
                            <a href="{{ url_for('employees.employee_devices', employee_id=emp.id) }}" 
                               class="badge bg-primary text-decoration-none" 
                               style="font-size: 0.9rem; padding: 0.4em 0.6em; cursor: pointer;"
                               title="–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ–≤–∞–π—Å—ã">
                                <i class="bi bi-laptop me-1"></i>{{ device_count }}
                            </a>
                        {% else %}
                            <span class="text-muted">‚Äî</span>
                        {% endif %}
                    </td>
                    <td class="text-end pe-4">
                        <div class="btn-group btn-group-sm">
                            <a href="{{ url_for('employees.edit_employee', employee_id=emp.id) }}" class="btn btn-outline-primary"><i class="bi bi-pencil"></i></a>
                            <form method="post" action="{{ url_for('employees.delete_employee', employee_id=emp.id) }}" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞?');" style="display: inline;">
                                <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                                <button type="submit" class="btn btn-outline-danger"><i class="bi bi-trash"></i></button>
                            </form>
                        </div>
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="6" class="text-center py-4" style="color: #95a5a6;">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–µ—Ç</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

